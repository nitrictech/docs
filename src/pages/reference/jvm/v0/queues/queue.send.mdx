export const description =
  "Reference for Nitric's JVM library - Send tasks to a queue."

# JVM - queue.send()

Send tasks to a queue.

<CodeGroup>

```java
import io.nitric.Nitric;
import io.nitric.resources.QueuePermission;

public class Application {
  public static void main(String[] args) {
    var queue = Nitric.INSTANCE.queue("batch").with(QueuePermission.Send);

    var payload = Map.of("message", "hello");
    queue.send(payload);

    Nitric.INSTANCE.run();
  }
}
```

```kotlin
import io.nitric.Nitric
import io.nitric.resources.QueuePermission

fun main() {
    val queue = Nitric.queue("batch").with(QueuePermission.Send)

    var payload = mapOf("message" to "hello")
    queue.send(payload)

    Nitric.run()
}
```

</CodeGroup>

## Parameters

<Properties>
  <Property name="tasks" required type="Task or List<Task>">
    A task or an array of tasks to send to the queue.
  </Property>
</Properties>

## Examples

### Send a task to a queue

<CodeGroup>

```java
import io.nitric.Nitric;
import io.nitric.resources.QueuePermission;

public class Application {
  public static void main(String[] args) {
    var queue = Nitric.INSTANCE.queue("batch").with(QueuePermission.Send);

    var payload = Map.of("message", "payloads can be any serializable object");
    queue.send(payload);

    Nitric.INSTANCE.run();
  }
}
```

```kotlin
import io.nitric.Nitric
import io.nitric.resources.QueuePermission

fun main() {
    val queue = Nitric.queue("batch").with(QueuePermission.Send)

    var payload = mapOf("message" to "payloads can be any serializable object")
    queue.send(payload)

    Nitric.run()
}
```

</CodeGroup>

### Send multiple tasks to a queue

```javascript
import { queue } from '@nitric/sdk'

const batchQueue = queue('batch').for('sending')

const tasks = [
  {
    payload: {
      type: 'Email',
      to: 'hello@example.com',
      subject: 'Notification',
      message: 'A notification from Nitric',
    },
  },
  {
    payload: {
      type: 'SMS',
      to: '+17200000000',
      message: 'A text message from Nitric',
    },
  },
]

await batchQueue.send(tasks)
```

<CodeGroup>

```java
import io.nitric.Nitric;
import io.nitric.resources.QueuePermission;

public class Application {
  public static void main(String[] args) {
    var queue = Nitric.INSTANCE.queue("batch").with(QueuePermission.Send);

    var payloads = List.of(
      Map.of(
        "type", "SMS",
        "to", "+172000000000",
        "subject", "Notification",
        "message", "A text message from Nitric"
      ),
      Map.of(
        "type", "Email",
        "to", "hello@example.com",
        "subject", "Notification",
        "message", "A notification from Nitric",
      )
    )
    queue.send(payloads);

    Nitric.INSTANCE.run();
  }
}
```

```kotlin
import io.nitric.Nitric
import io.nitric.resources.QueuePermission

fun main() {
    val queue = Nitric.queue("batch").with(QueuePermission.Send)

    var payloads = listOf(
      mapOf(
        "type" to "SMS",
        "to" to "+172000000000",
        "subject" to "Notification",
        "message" to "A text message from Nitric"
      ),
      mapOf(
        "type" to "Email",
        "to" to "hello@example.com",
        "subject" to "Notification",
        "message" to "A notification from Nitric",
      )
    )
    queue.send(payload)

    Nitric.run()
}
```

</CodeGroup>

### Dealing with failures

In rare cases when sending tasks to a queue some tasks might fail to be sent. The response from `send()` will include an array of any tasks that failed to send. You can process this array to retry or log the error.

```javascript
const failed = await batchQueue.send(tasks)

for (const task in failed) {
  console.log(task)
}
```

<CodeGroup>

```java
var failed = queue.send(tasks);

failed.forEach((task) -> {
  System.out.println(task);
});
```

```kotlin
val failed = queue.send(tasks)

failed.forEach { task ->
  println(task)
}
```

</CodeGroup>
