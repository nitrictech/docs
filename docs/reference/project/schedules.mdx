> Schedules are currently only supported on AWS and GCP. With support for other platforms coming soon.

Configuring cron jobs directly on servers used to be quite common. However, Serverless environments where servers only run in response to requests/load make this more challenging. Directly configuring servers was also error prone, since the schedule configuration didn't employ version control and CI/CD processes.

Nitric Schedules enable a Serverless approach to scheduled tasks, allowing you to trigger batch and fan-out workloads on a fixed cadence. Schedules are defined directly in the Nitric Stack Definition, enabling the use of version control and automated deployments for all scheduled activities. Schedule triggers are delivered via Topics using [Events](/docs/reference/api/events), ensuring compatibility with both Serverless and traditional infrastructure.

## Creating a Schedule

Schedules are purely configuration in a Nitric Stack, requiring no code.

To start, let's look at an example, where a [Function](./functions) is triggered via a Topic every 5 minutes. In this example we define a new schedule named `my-schedule', and a cron expression for that schedule that defines when it runs. Additionally, the schedule defines what (event) and where (topic) to send the payload generated by the schedule.

```yaml
name: schedule-example

functions:
  	example:
    	handler: functions/example.ts
		  # A standard topic trigger is defined, so that the function will respond to events
      triggers:
        topics:
          - my-topic

# Nitric collections
collections:
  examples: {}

# A topic is defined for the events
topics:
  my-topic: {}

# a schedule is defined for what, where and when to send
schedules:
  my-schedule:
    # an example expression which runs every 5 mins
    expression: '*/5 * * * *'
    target:
      type: topic
      name: my-topic
    event:
      payloadType: example-payload
      payload:
        example: payload
```

## Cron Expressions

Schedule expressions are defined using <a href="https://man7.org/linux/man-pages/man5/crontab.5.html" target="_blank">unix-cron format</a>.

```
* * * * *
```

## Restrictions

A few limitations are imposed on the expressions used in order to ensure compatibility with the schedulers available from cloud providers:

- Day of Month and Day of Year can't both be set to a value other than `*`, you can overcome this limitation by defining two schedules.
- Expressions that lead to triggers that exceed 1/minute are not supported.

> All schedules are currently triggered via Topics. This maximizes compatibility, however, direct Function triggers may be considered in future.

## Other Notes

### Testing Schedules

> Coming Soon

Currently, local execution and testing of schedules is not supported. Local and manual testing of schedules is on our backlog to be completed soon.

In the meantime, you can directly test the functions that respond to scheduled triggers by sending HTTP requests to those functions with the same payload as defined in your schedule (Events and Requests are treated the same when writing functions). Schedules themselves need to be tested in a supported cloud environment.

### AWS Cron Expressions

When directly configuring schedules in AWS EventBridge a unix-like expression format, similar to <a href="https://www.javadoc.io/doc/org.quartz-scheduler/quartz/1.8.2/org/quartz/CronExpression.html" target="_blank">Quartz Scheduler Format</a>, is used which requires 6 values (instead of 5 for unix-cron or 6-7 for quartz). This format isn't supported by Nitric Schedules, instead the unix-cron expression you provide will be automatically converted to the AWS cron equivalent during deployment.

Because of the conversion, the expression displayed in the AWS Console for EventBridge Rules deployed by Nitric won't directly match the expression defined in your stack template.

Some notable differences between these formats include:

- Day of Month or Day of Week will be set to a `?` character
- An additional `year` value will be appended, this value will always be set to `*`
- Numeric Day of Week values will be incremented by 1 (unix-cron values start at 0 (Sunday), AWS cron values start at 1 (Sunday))

For example, the expression `*/1 * * * 1-3` will appear as `0/1 * ? * 2-4 *` in the AWS Console. The resulting expression is functionally equivalent.
