---
description: 'Nitric Schedule'
---

# Schedules

## 1. System Context

**Developers** use Nitric to defined scheduled tasks within their application.

- App code uses the [Schedule resource](/schedules) from the Nitric SDK.
- Developers configure the schedule with CRON or rate expressions like '7 days' and implement application logic to be executed when triggered.

**Operations** use default/extended or overridden Terraform modules to provision the necessary resources to run the app logic on the defined schedule.

<details>
  <summary>Example AWS Provider</summary>

- **Lambda function** is deployed as a packaged container image uploaded to an Amazon Elastic Container Registry (Amazon ECR).
- **AWS EventBridge** is used to schedule and trigger Lambda functions.
- **AWS IAM** provides the role/policies allowing EventBridge to invoke the Lambda functions securely.

```mermaid
flowchart TD
    Developer["Developer"]
    Operations["Operations"]
    App["nitric up"]
    EventBridge["EventBridge<br>(AWS Scheduler)"]
    Lambda["AWS Lambda<br>Deployed function(s)"]
    IAM["AWS IAM"]

    Developer -->|Code| App
    Operations -->|Terraform| App
    App -->|Create AWS schedules| EventBridge
    App -->|Create AWS IAM Roles / Policies| IAM
    EventBridge -->|Invokes| Lambda
    IAM -->|Attach Policy| Lambda
    App -->|Deploy Container App| Lambda

classDef default line-height:1;
classDef edgeLabel line-height:2;
```

</details>
<details>
  <summary>Example GCP Provider</summary>

- **Google Cloud Run** is deployed as a container image stored in **Google Artifact Registry (GCR)**.
- **Google Cloud Scheduler** is used to schedule and trigger **Google Cloud Run** functions via an HTTP trigger.
- **Google IAM** provides the role/policies allowing **Cloud Scheduler** to invoke the **Cloud Run** service securely.

```mermaid
flowchart TD
    Developer["Developer"]
    Operations["Operations"]
    App["nitric up"]
    CloudScheduler["Cloud Scheduler<br>(GCP Scheduler)"]
    CloudRun["Google Cloud Run<br>Deployed function(s)"]
    IAM["Google IAM"]

    Developer -->|Code| App
    Operations -->|Terraform| App
    App -->|Create GCP schedules| CloudScheduler
    App -->|Create GCP IAM Roles / Policies| IAM
    CloudScheduler -->|Invokes| CloudRun
    IAM -->|Attach Policy| CloudRun
    App -->|Deploy Container App| CloudRun

classDef default line-height:1;
classDef edgeLabel line-height:2;
```

</details>

## 2. Sequence

```mermaid
sequenceDiagram
    participant Developer as Developer
    participant NitricSDK as Nitric SDK
    participant NitricRuntime as Nitric Runtime
    participant Scheduler as Cloud Scheduler
    participant Worker as Application Worker

    Developer->>NitricSDK: Define schedule (e.g., CRON job)
    NitricSDK->>NitricRuntime: Deploy schedule configuration
    NitricRuntime->>Scheduler: Create schedule in cloud scheduler

    Scheduler->>NitricRuntime: Trigger scheduled task (e.g., CRON event)
    NitricRuntime->>Worker: Forward scheduled event with payload
    Worker-->>NitricRuntime: Process task and return result
    NitricRuntime-->>Scheduler: Confirm execution (success or error)
```

## 3. Component

### Schedule Module

- Dynamically creates the necessary roles and permissions for the scheduling service to securely trigger application tasks, enforcing the principle of least privilege.
- Configures the scheduling system with CRON or rate expressions and supports additional parameters like time zones for flexibility.
- Automatically attaches policies to allow secure invocation of application functions or services when schedules are triggered.
- Supports passing custom event payloads to tasks, enabling dynamic behavior and workflows.
- Abstracts the underlying scheduler implementations, allowing developers and operations teams to interact with a unified scheduling interface without concerning themselves with provider-specific configurations.
- Enables seamless integration of recurring or scheduled tasks into applications without manual setup of complex cloud-native scheduling systems.

## 4. Code

**Developers** write application code like the following examples that uses the [Schedule resource](/schedules) from the SDK, configure the schedule and implement the application code that will execute.

SDK Reference by language -

- [NodeJS SDK](/reference/nodejs/schedule/schedule)
- [Python SDK](/reference/python/schedule/schedule)
- [GO SDK](/reference/go/schedule/schedule)
- [Dart SDK](/reference/dart/schedule/schedule)

**Operations** will use or extend the Nitric Terraform reference modules:

- [AWS Schedule Terrform Module](https://github.com/nitrictech/nitric/blob/main/cloud/aws/deploytf/.nitric/modules/schedule/main.tf)
- [GCP Schedule Terrform Module](https://github.com/nitrictech/nitric/blob/main/cloud/gcp/deploytf/.nitric/modules/schedule/main.tf)
